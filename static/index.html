<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>room</title>
        <link rel="stylesheet" type="text/css" href="css/ui-lightness/jquery-ui-1.8.18.custom.css" />
        <script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.8.18.custom.min.js"></script>
        <script type="text/javascript" src="js/Three.js"></script>
        <script type="text/javascript" src="js/ammo.js"></script>
        <script type="text/javascript" src="js/Tween.js"></script>
        <script type="text/javascript" src="js/SphereControls.js"></script>
        <script type="text/javascript" src="js/colors.js"></script>
        <script type="text/javascript" src="js/room3.js"></script>
        <script type="text/javascript">
            var room;
            $(document).ready(function () {
                room = new ROOM3.Room($('#viewport'));
                room.init();
                room.animate();

                $('button').click(function () {
                    $('#save_snapshot').dialog('open');
                });

                $('#save_snapshot').dialog({
                    autoOpen: false,
                    height: 300,
                    width: 350,
                    modal: true,
                    buttons: {
                        ok: function () {
                            var name = $('#name').val();
                            var dataurl = room.toDataURL();
                            $.post('/savescene', {
                                name: name,
                                dataurl: dataurl
                            });
                            $(this).dialog('close');
                        },
                        cancel: function () {
                            $(this).dialog('close');
                        }
                    },
                    close: function () {
                        $('#name').val('');
                    }
                });
            });
            var addBlocks = function (n) {
                var added = 0;
                var interval = setInterval(function () {
                    room.addBox();
                    added += 1;
                    if (added === n) {
                        clearInterval(interval);
                    }
                }, 1000);
            };
        </script>
    </head>
    <body>
        <button>save scene</button>
        <div id="viewport"></div>
        <div id="save_snapshot" title="save snapshot" style="display:none">
            <form>
                <fieldset>
                    <label for="name">name</label>
                    <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
                </fieldset>
            </form>
        </div>
    </body>
</html>
